<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ML System Design Flowchart</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background-color: #f8fafc;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .flowchart-container {
      max-width: 900px;
      width: 100%;
      background-color: #ffffff;
      border-radius: 12px;
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
      padding: 30px;
    }

    .stage {
      background-color: #f1f5f9;
      border-radius: 10px;
      padding: 20px;
      margin: 15px 0;
      position: relative;
      transition: all 0.3s ease;
    }

    .stage:hover {
      background-color: #e2e8f0;
      transform: translateY(-2px);
    }

    .stage h3 {
      margin: 0 0 12px;
      color: #1e293b;
      font-size: 20px;
      font-weight: 600;
      display: flex;
      align-items: center;
    }

    .stage h3::before {
      content: '';
      display: inline-block;
      width: 28px;
      height: 28px;
      margin-right: 12px;
      background-size: contain;
      background-repeat: no-repeat;
    }

    .stage.objectives h3::before { background-image: url('https://img.icons8.com/ios-filled/28/target.png'); }
    .stage.clarification h3::before { background-image: url('https://img.icons8.com/ios-filled/28/question-mark.png'); }
    .stage.data-prep h3::before { background-image: url('https://img.icons8.com/ios-filled/28/filter.png'); }
    .stage.model-dev h3::before { background-image: url('https://img.icons8.com/ios-filled/28/artificial-intelligence.png'); }
    .stage.model-eval h3::before { background-image: url('https://img.icons8.com/ios-filled/28/checklist.png'); }
    .stage.deployment h3::before { background-image: url('https://img.icons8.com/ios-filled/28/server.png'); }
    .stage.monitoring h3::before { background-image: url('https://img.icons8.com/ios-filled/28/dashboard.png'); }

    .stage p, .stage li {
      margin: 6px 0;
      color: #475569;
      font-size: 15px;
      line-height: 1.6;
    }

    .stage ul {
      padding-left: 20px;
      margin: 10px 0;
    }

    .rationale {
      font-style: italic;
      color: #2563eb;
      margin-top: 12px;
      font-size: 14px;
      border-left: 3px solid #2563eb;
      padding-left: 10px;
    }

    .arrow {
      text-align: center;
      font-size: 30px;
      color: #2563eb;
      margin: 15px 0;
    }

    .feedback-loop {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 12px;
      color: #28a745;
      writing-mode: vertical-rl;
    }

    .task {
      background-color: #ffffff;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 15px;
      margin: 10px 0;
    }

    .task h4 {
      margin: 0 0 8px;
      color: #1e293b;
      font-size: 16px;
      font-weight: 500;
    }

    @media (max-width: 600px) {
      .flowchart-container {
        padding: 15px;
      }

      .stage h3 {
        font-size: 18px;
      }

      .stage p, .stage li, .rationale {
        font-size: 13px;
      }

      .stage h3::before {
        width: 24px;
        height: 24px;
      }
    }
  </style>
</head>
<body>
  <div class="flowchart-container">
    <div class="stage objectives">
      <h3>Business Objectives</h3>
      <ul>
        <li>Detect early Spot Instance terminations to remove business risk.</li>
        <li>Predict cloud usage to optimize instance lifecycle.</li>
        <li><strong>Goal:</strong> Increase cost savings while maintaining service reliability.</li>
        <li><strong>Target Users:</strong>
          <ul>
            <li>IDC teams: Manage enterprise cloud for clients with small IT teams.</li>
            <li>FinOps teams: Optimize spend across diverse workloads.</li>
          </ul>
        </li>
      </ul>
      <p class="rationale">Rationale: Focus on cost savings and reliability drives ML task prioritization, ensuring user value through risk mitigation and efficiency.</p>
    </div>
    <div class="arrow">↓</div>
    <div class="stage clarification">
      <h3>Clarification Questions</h3>
      <ul>
        <li><strong>Platform:</strong> Desktop platform, data in cloud.</li>
        <li><strong>Scale:</strong> Handle 100s-1000s of instances over next year.</li>
        <li><strong>Performance:</strong> Latency < 1 min, predictions every 5 mins, 15-min window accuracy.</li>
        <li><strong>Data Sources:</strong> AWS CloudWatch, EC2 logs, billing info?</li>
        <li><strong>Data Collection:</strong> Real-time or batch frequency?</li>
      </ul>
      <p class="rationale">Rationale: Clarifications ensure system aligns with business goals, setting clear expectations for scalability and performance.</p>
    </div>
    <div class="arrow">↓</div>
    <div class="stage data-prep">
      <h3>Data Preparation</h3>
      <ul>
        <li>Normalize data (Min-Max/Z-score), impute missing values (mean/forward fill).</li>
        <li>Create 15-min time windows, rolling averages, lag features.</li>
        <li>Label creation (0=alive, 1=terminated), split train/val/test.</li>
        <li>Address skew with SMOTE, log-transforms.</li>
      </ul>
      <p class="rationale">Rationale: High-quality data preparation reduces bias, speeds up model training, and balances speed to market with robustness.</p>
    </div>
    <div class="arrow">↓</div>
    <div class="stage model-dev">
      <h3>Model Development</h3>
      <div class="task">
        <h4>Termination Detection (Binary Classification)</h4>
        <p>Monitor terminations, auto-transition in 15-min window.</p>
        <p><strong>Approach:</strong> Logistic Regression → XGBoost, optional LSTM.</p>
      </div>
      <div class="task">
        <h4>Usage Prediction (Time Series Forecasting)</h4>
        <p>Forecast usage for scaling, anomaly detection for risks.</p>
        <p><strong>Approach:</strong> Linear Regression → Prophet/LSTM, Isolation Forest for anomalies.</p>
      </div>
      <p class="rationale">Rationale: Simple models establish baselines, advanced models improve accuracy, balancing complexity with real-time adaptability.</p>
    </div>
    <div class="arrow">↓</div>
    <div class="stage model-eval">
      <h3>Model Evaluation</h3>
      <ul>
        <li><strong>Termination Detection:</strong> Recall, Precision, F1 Score.</li>
        <li><strong>Usage Prediction:</strong> RMSE, MAPE.</li>
        <li><strong>Anomaly Detection:</strong> Detection Rate, False Positive Rate.</li>
      </ul>
      <p class="rationale">Rationale: Metrics ensure models align with production needs, maximizing prediction accuracy and cost savings.</p>
    </div>
    <div class="arrow">↓</div>
    <div class="stage deployment">
      <h3>Serving & Deployment</h3>
      <ul>
        <li>Real-time scoring every 5 mins.</li>
        <li>Integrate AWS pricing API for dynamic decisions.</li>
        <li>Auto-transition, record savings impact.</li>
      </ul>
      <p class="rationale">Rationale: Fresh, responsive models minimize disruptions and optimize cost efficiency for users.</p>
    </div>
    <div class="arrow">↓</div>
    <div class="stage monitoring">
      <h3>Monitoring & Infrastructure</h3>
      <ul>
        <li>Track drift, overfitting with MLflow, Grafana.</li>
        <li>Retrain based on accuracy/usage patterns.</li>
        <li>Compression (quantization, pruning) for efficiency.</li>
      </ul>
      <p class="rationale">Rationale: Continuous monitoring minimizes failures, maintains accuracy, and ensures scalable, reliable performance.</p>
      <div class="feedback-loop">Feedback Loop to Model Dev</div>
    </div>
  </div>
</body>
</html>